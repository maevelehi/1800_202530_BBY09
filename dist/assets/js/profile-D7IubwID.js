import"./app-DbvmmK9C.js";import{a as l,o as f,d as c,b as u,g,u as p}from"./site-navbar--heEX1I6.js";import"./site-footer-Due56cgJ.js";import"./main-CZ2i7WNr.js";function I(){f(l,async n=>{if(n)try{const e=c(u,"users",n.uid),t=await g(e);if(t.exists()){const o=t.data(),{name:r="",school:a="",group:s="",avatarUrl:d=""}=o;document.getElementById("nameInput").value=r,document.getElementById("schoolInput").value=a,document.getElementById("groupInput").value=s,d&&(document.getElementById("avatar").src=d)}else console.log("No such document!")}catch(e){console.error("Error getting user document:",e)}else console.log("No user is signed in")})}function y(){document.getElementById("personalInfoFields").disabled=!1,document.getElementById("editProfileBtn").textContent="Save Profile"}async function E(n,e,t,o,r){try{const a=c(u,"users",n);await p(a,{name:e,school:t,group:o,avatarUrl:r,lastUpdated:new Date}),console.log("User document successfully updated!")}catch(a){throw console.error("Error updating user document:",a),a}}async function v(){const n=l.currentUser;if(!n){alert("No user is signed in. Please log in first.");return}const e=document.getElementById("nameInput"),t=document.getElementById("schoolInput"),o=document.getElementById("groupInput"),r=document.getElementById("avatar"),a=e?.value.trim(),s=t?.value.trim(),d=o?.value,i=r.src;if(!a||!s){alert("Please fill in all required fields (Name and School).");return}try{await E(n.uid,a,s,d,i),document.getElementById("personalInfoFields").disabled=!0,document.getElementById("editProfileBtn").textContent="Edit Profile",alert("Profile updated successfully!")}catch(m){console.error("Error saving profile:",m),alert("Failed to save profile. Please try again.")}}function B(n){const e=n.target.files[0];if(e){const t=new FileReader;t.onload=function(o){document.getElementById("avatar").src=o.target.result},t.readAsDataURL(e)}}document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("editProfileBtn");n&&n.addEventListener("click",function(){document.getElementById("personalInfoFields").disabled?y():v()});const e=document.getElementById("backButton");e&&e.addEventListener("click",function(){window.history.back()});const t=document.getElementById("avatarUpload"),o=document.getElementById("uploadAvatarBtn");o&&t&&(o.addEventListener("click",function(){t.click()}),t.addEventListener("change",B)),I()});
